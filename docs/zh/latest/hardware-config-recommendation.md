# 硬件环境推荐

## 功能测试

### HA版本

说明：

1. 若只做功能测试，则MySQL数据库服务可采用虚拟机的方式部署，HotDB服务推荐部署在物理服务器上。
2. 若不测试HotDB服务切换的功能，则只需要一台物理服务器部署HotDB服务。
3. 若功能测试和性能测试共用一套环境，则推荐MySQL数据库服务和HotDB服务都采用物理服务器的方式部署。

| 配置项/系统名称 | 处理器 | 内存 | 硬盘 | RAID卡 | 网卡 | 服务器数量 |
|---|---|---|---|---|---|---|
| HotDB  Server服务端服务器（兼HotDB Serve端配置库） | Silver 4116*2颗 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 2.5' 200G 混合使用型 SATA  SSD *2 RAID 1 | H330 | 千兆多队列网卡或万兆网卡 | 2台 |
| MySQL数据库服务器 | Silver 4110*2颗 | 8G*12根 | 2.5' 400G 混合使用型 SATA  SSD *6 RAID 5 | H730P | 板载千兆或千兆网卡 | 至少2台 |
| HotDB Managment配置库服务器 | Silver 4110*1颗 | 8G*6根 | 2.5' 400G 混合使用型 SATA  SSD *2 RAID 1 | H730P | 板载千兆或千兆网卡 | 2或复用（管理多套HotDB  sever也只需要2台做主从） |
| HotDB Managment服务端服务器 | Silver 4108*1颗 | 8G*6根 | 2.5' 240G SATA SSD *1 | - | 板载千兆 | 1或复用（管理多套HotDB  sever也只需要1台） |
| 功能/压力测试发起服务器 | Silver 4110*2颗 | 8G*12根  有单条4G内存的情况下建议4G*12根 | 2.5' 240G SATA SSD *1 | - | 千兆多队列网卡或万兆网卡 | 1～N（根据需求配置） |

特别说明：

1. 以上配置以DELL服务器为例，其它厂商机型选择同等配置即可。
2. MySQL数据库服务器数量是以性能测试的TPS/QPS目标为准，描述的MySQL数据库服务器单台处理能力且主备延迟控制在1秒以内的稳定态数值：TPS  4000-6000，QPS：15000左右（注：读为主的情况下则QPS会更高）。本配置默认为性能测试给出的是8台、4对，且采用双主复制交叉部署，则可测试TPS  4万以上、QPS 12万以上的场景。

### 集群版本

说明：

1. 若只做功能测试，则MySQL数据库服务可采用虚拟机的方式部署，HotDB服务推荐部署在物理服务器上。
2. 若不测试HotDB服务切换的功能，则只需要一台物理服务器部署HotDB服务。
3. 若功能测试和性能测试共用一套环境，则推荐MySQL数据库服务和HotDB服务都采用物理服务器的方式部署。

| 配置项/系统名称 | 处理器 | 内存 | 硬盘 | RAID卡 | 网卡 | 服务器数量 |
|---|---|---|---|---|---|---|
| HotDB  Server服务端服务器     （兼HotDB Serve端配置库） | Silver 4116*2颗 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 2.5' 200G 混合使用型 SATA  SSD *2 RAID 1 | H330 | 千兆多队列网卡或万兆网卡 | 3台 |
| LVS服务器（集群版需要VIP时） | Silver 4110*2颗 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 2.5' 240G SATA SSD *1 | - | 千兆多队列网卡或万兆网卡 | 2台 |
| MySQL数据库服务器 | Silver 4110*2颗 | 8G*12根 | 2.5' 400G 混合使用型 SATA  SSD *6 RAID 5 | H730P | 板载千兆或千兆网卡 | 至少2台 |
| HotDB Managment配置库服务器 | Silver 4110*1颗 | 8G*6根 | 2.5' 400G 混合使用型 SATA  SSD *2 RAID 1 | H730P | 板载千兆或千兆网卡 | 2或复用（管理多套HotDB  sever也只需要2台做主从） |
| HotDB Managment服务端服务器 | Silver 4108*1颗 | 8G*6根 | 2.5' 240G SATA SSD *1 | - | 板载千兆 | 1或复用（管理多套HotDB  sever也只需要1台） |
| 功能/压力测试发起服务器 | Silver 4110*2颗 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 2.5' 240G SATA SSD *1 | - | 千兆多队列网卡或万兆网卡 | 1～N（根据需求配置） |

特别说明：

1. 以上配置以DELL服务器为例，其它厂商机型选择同等配置即可。
2. MySQL数据库服务器数量是以性能测试的TPS/QPS目标为准，描述的MySQL数据库服务器单台处理能力且主备延迟控制在1秒以内的稳定态数值：TPS  4000-6000，QPS：15000左右（注：读为主的情况下则QPS会更高）。本配置默认为性能测试给出的是8台、4对，且采用双主复制交叉部署，则可测试TPS  4万以上、QPS 12万以上的场景。

## 生产环境

### HA版本

| 配置项/系统名称 | CPU /最低配置 | CPU/推荐配置 | CPU/最高配置 | RAID卡/最低配置 | RAID卡/推荐配置 | RAID卡/最高配置 | 硬盘/最低配置 | 硬盘/推荐配置 | 硬盘/最高配置 | RAID卡/最低配置 | RAID卡/推荐配置 | RAID卡/最高配置 | 网卡/最低配置 | 网卡/推荐配置 | 网卡/最高配置 | 机型   /最低配置 | 机型  /最高配置 | 服务器数量 |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| HotDB  Server服务端服务器     兼HotDB Serve配置库服务器     （集群版HotDB server建议保持一台配置库单独占用服务器，不与HotDB server或数据源服务器共用） | Silver 4116*2颗 | Gold 6130*2颗 | Gold 6152*2颗 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根 | 2.5' 200G 混合使用型 SATA  SSD *2 RAID 1 | 2.5'  800G 写入密集型 SATA\SAS SSD *2 RAID 1     （选用800G原因为写入寿命更长） | 2.5'  240G SATA SSD *2 RAID 1（用于系统）     +PCIe 375G intel DC P4800X NVME（用于HotDB） | H330 | H730P | H330 | 千兆多队列网卡 | 万兆网卡 | 万兆网卡 | R440 | R440 | 2台 |
| MySQL数据源服务器 | Silver 4110*2颗 | Silver 4116*2颗 | Gold 6126*2颗 | 8G*12根 | 16G*12根 | 16G*12根 | 2.5' 400G 混合使用型 SATA  SSD *6 RAID 5 | 2.5'  2.4T 10K SAS HDD *2 RAID 1（用于系统与备份文件存储）     +2.5' 800G 写入密集型 SATA\SAS SSD *6 RAID 5（用于MySQL） | 2.5'  2.4T 10K SAS HDD *2 RAID 1（用于系统与备份文件存储）     +PCIe 4T intel DC P4600 NVME（用于MySQL） | H730P | H730P | H330 | 板载千兆 | 千兆网卡 | 万兆网卡 | R440 | R440 | 至少2台，按需添加 |
| HotDB  Managment配置库服务器 | Silver 4110*1颗 | Silver 4110*2颗 | Silver 4110*2颗 | 8G*6根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 2.5' 400G 混合使用型 SATA  SSD *2 RAID 1 | 2.5'  400G 写入密集型 SATA\SAS SSD *2 RAID 1 | 2.5'  400G 写入密集型 SATA\SAS SSD *2 RAID 1 | H330 | H730P | H730P | 板载千兆 | 千兆网卡 | 千兆网卡 | 复用 | R440 | 0 |
| HotDB  Managment服务端服务器 | Silver 4108*1颗 | Silver 4108*2颗 | Silver 4108*2颗 | 8G*6根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 2.5' 240G SATA SSD *1 | 2.5' 240G SATA SSD *2  RAID 1 | 2.5' 240G SATA SSD *2  RAID 1 | - | H330 | H330 | 板载千兆 | 板载千兆 | 千兆网卡 | 复用 | R440 | 0 |

交换机：要求交换机包转发速率超过10Mpps或支持线速转发。建议所有服务器部署在同一交换机（或堆叠）下，若无法做到，应采取网络跳数尽可能少的部署方式。若部署高可用网络，建议优先使用Bond0模式。

特别说明：

1. 以上配置以DELL服务器为例，其它厂商机型选择同等或类似配置即可。
2. 生产环境的MySQL数据库服务都是默认推荐采用双主架构（注：M-M），或者双主衍生架构（例如：M-M-S、S-M-M-S、2S-M-M-2S等）。
3. 生产环境默认不推荐MySQL数据库服务采用虚拟机方式部署，原因为虚拟机的网络和IO的瓶颈，IO能力和处理机制容易导致出现mysqld服务HANG住、主备数据同步延迟大（注：生产环境至少要控制1秒以内），及断电等极端故障情况下容易出现数据文件损坏而较难恢复。
4. 磁盘数量和空间大小可按需调整，但应当注意适度，RAID5超过8块盘应当增加热备盘或改用RAID 50。
5. 生产环境和性能测试环境HotDB  Server服务端要求实体机部署。原因为虚拟机的网络瓶颈非常严重，无法达到预期的性能与稳定性。且可能涉及多台关键服务器在同一宿主机争抢资源，MySQL主从都在一台物理服务器等问题。

### 集群版本

| 配置项/系统名称 | CPU /最低配置 | CPU/推荐配置 | CPU/最高配置 | RAID卡/最低配置 | RAID卡/推荐配置 | RAID卡/最高配置 | 硬盘/最低配置 | 硬盘/推荐配置 | 硬盘/最高配置 | RAID卡/最低配置 | RAID卡/推荐配置 | RAID卡/最高配置 | 网卡/最低配置 | 网卡/推荐配置 | 网卡/最高配置 | 机型   /最低配置 | 机型  /最高配置 | 服务器数量 |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| HotDB  Server服务端服务器     兼HotDB Serve配置库服务器     （集群版HotDB server建议保持一台配置库单独占用服务器，不与HotDB server或数据源服务器共用） | Silver 4116*2颗 | Gold 6130*2颗 | Gold 6152*2颗 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根 | 2.5' 200G 混合使用型  SATA SSD *2 RAID 1 | 2.5' 800G 写入密集型  SATA\SAS SSD *2 RAID 1     （选用800G原因为写入寿命更长） | 2.5' 240G SATA  SSD *2 RAID 1（用于系统）     +PCIe 375G intel DC P4800X NVME（用于HotDB） | H330 | H730P | H330 | 千兆多队列网卡 | 万兆网卡 | 万兆网卡 | R440 | R440 | 至少3台（最高9台），按需添加 |
| LVS服务器（集群版需要VIP时） | Silver 4110*2颗 | Silver 4116*2颗 | Gold 6126*2颗 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 2.5' 240G SATA SSD *1 | 2.5' 240G SATA SSD *2  RAID 1 | 2.5' 240G SATA SSD *2  RAID 1 | - | H330 | H330 | 千兆多队列网卡 | 万兆网卡 | 万兆网卡 | R440 | R440 | 2台 |
| MySQL数据源服务器 | Silver 4110*2颗 | Silver 4116*2颗 | Gold 6126*2颗 | 8G*12根 | 16G*12根 | 16G*12根 | 2.5' 400G 混合使用型 SATA  SSD *6 RAID 5 | 2.5'  2.4T 10K SAS HDD *2 RAID 1（用于系统与备份文件存储）     +2.5' 800G 写入密集型 SATA\SAS SSD *6 RAID 5（用于MySQL） | 2.5'  2.4T 10K SAS HDD *2 RAID 1（用于系统与备份文件存储）     +PCIe 4T intel DC P4600 NVME（用于MySQL） | H730P | H730P | H330 | 板载千兆 | 千兆网卡 | 万兆网卡 | R440 | R440 | 至少2台，按需添加 |
| HotDB  Managment配置库服务器 | Silver 4110*1颗 | Silver 4110*2颗 | Silver 4110*2颗 | 8G*6根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 2.5' 400G 混合使用型 SATA  SSD *2 RAID 1 | 2.5'  400G 写入密集型 SATA\SAS SSD *2 RAID 1 | 2.5'  400G 写入密集型 SATA\SAS SSD *2 RAID 1 | H330 | H730P | H730P | 板载千兆 | 千兆网卡 | 千兆网卡 | 复用 | R440 | 0 |
| HotDB  Managment服务端服务器 | Silver 4108*1颗 | Silver 4108*2颗 | Silver 4108*2颗 | 8G*6根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 8G*12根     有单条4G内存的情况下建议4G*12根 | 2.5' 240G SATA SSD *1 | 2.5' 240G SATA SSD *2  RAID 1 | 2.5' 240G SATA SSD *2  RAID 1 | - | H330 | H330 | 板载千兆 | 板载千兆 | 千兆网卡 | 复用 | R440 | 0 |

特别说明：

1. 以上配置以DELL服务器为例，其它厂商机型选择同等或类似配置即可。
2. 生产环境的MySQL数据库服务都是默认推荐采用双主架构（注：M-M），或者双主衍生架构（例如：M-M-S、S-M-M-S、2S-M-M-2S等）。
3. 生产环境默认不推荐MySQL数据库服务采用虚拟机方式部署，原因为虚拟机的网络和IO的瓶颈，IO能力和处理机制容易导致出现mysqld服务HANG住、主备数据同步延迟大（注：生产环境至少要控制1秒以内），及断电等极端故障情况下容易出现数据文件损坏而较难恢复。
4. 磁盘数量和空间大小可按需调整，但应当注意适度，RAID5超过8块盘应当增加热备盘或改用RAID 50。
5. 生产环境和性能测试环境HotDB Server服务端要求实体机部署。原因为虚拟机的网络瓶颈非常严重，无法达到预期的性能与稳定性。且可能涉及多台关键服务器在同一宿主机争抢资源，MySQL主从都在一台物理服务器等问题。

